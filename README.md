# Экспорт данных для кассового плана в ЕИС ГОЗ
Добавьте краткое описание проекта, опишите какую задачу он решает. 1-3 предложения будет достаточно. Добавьте бейджи для важных статусов проекта: статус разработки (в разработке, на поддержке и т.д.), статус билда, процент покрытия тестами и тд.

## Содержание
- [Начало работы](#начало-работы)
- [To do](#to-do)


## Использование

Для работы необходим XLS(x) файл с 2 листами : "Форма 8" и "Supplement" (не принципиально)
Все данные на листах должны быть в текстовом формате!!! "квартал" - арабской цифрой и т.д. 
В файле config.json определены важные переменные для чтения/выгрузки:
c начальными все очевидно, при первой отправке необходимо выставить previousUID = "0"
дальше конфиг будет обновляться при каждом экспорте
в переменных 
"GOZUID": "H3",
        "ContractDate": "F3",
        "Year": "D3",
        "Ouarter": "B3",
        "Salary": "C9",
        "Taxes": "C10",
        "Rates": "C11",
        "Other": "C12",
        "Reserve": "C13",
        "Income": "C14",
определены ячейки файла 
ОСОБОЕ ВНИМАНИЕ К наименованию организации - должно быть большими буквами и следите за экранированием кавычек - правила русского языка не работают ;)
в файлах есть пример xls формы.
ОСОБОЕ ВНИМАНИЕ к файлу sign - необходимо удалить хедер и футер файла (-----begin-----) и (------end-----)

необходимо установить python>=3.10 и несколько библиотек

Установите библиотеки с помощью команд:
```sh/cmd
$ pip install pytz, openpyxl
```
запустите скрипт 
```
python /path/export_v2.py
```
в появившемся окне необходимо выбрать файл с заполненными формами, по результату работы которого сгенерируется message.xml и архив с правильным названием.
после чего необходимо подписать файл message.xml, переименовать полученный файл *.sign в "message.sign" и добавить его в озвученный ранее архив, можно пробовать отправлять



## To do
- [x] пройти валидацию
- [ ] Провести рефакторинг кода - мусор ад и израиль..
- [ ] ...



